<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About Me</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Header placeholder -->
    <div id="header-placeholder"></div>

    <main>
        <h1>Skills</h1>
        <h2>Languages Used</h2>
        <h5 id="language-data-message">Select a piece of pie for language data.</h5>

        <h3>Past 30 Days</h3>
        <!-- Chart section for Past 30 Days -->
        <div id="chart-container">
            <canvas id="wakatime30DayLangChart" class="wakatimeLangChart"></canvas>
        </div>

        <h3>All Time</h3>
        <!-- Chart section for All Time -->
        <div id="chart-container">
            <canvas id="wakatimeAllTimeLangChart" class="wakatimeLangChart"></canvas>
        </div>
    </main>

    <!-- Footer placeholder -->
    <div id="footer-placeholder"></div>

    <!-- External JS files -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
    // Load the header
    fetch("header.html")
        .then(response => response.text())
        .then(data => {
            document.getElementById("header-placeholder").innerHTML = data;

            // Attach the hamburger menu toggle functionality after header is loaded
            const menuToggle = document.getElementById("mobile-menu");
            const navbar = document.getElementById("navbar").querySelector("ul");

            // Ensure the event listener is attached to the menu toggle
            menuToggle.addEventListener("click", function () {
                navbar.classList.toggle("active"); // This adds or removes the 'active' class
            });
        });

    // Load the footer
    fetch("footer.html")
        .then(response => response.text())
        .then(data => {
            document.getElementById("footer-placeholder").innerHTML = data;
        });

    // Load WakaTime data for "Past 30 Days"
    fetch('https://wakatime.com/share/@telloviz/e49e51a9-de2a-4db3-aa66-877d02a49ec1.json')
        .then(response => response.json())
        .then(data => {
            const labels = data.data.map(lang => lang.name);
            const dataValues = data.data.map(lang => lang.percent);
            const backgroundColors = data.data.map(lang => lang.color);
            const timeSpent = data.data.map(lang => lang.text); // Time spent on each language

            // Initialize the "Past 30 Days" chart
            const ctx30Days = document.getElementById('wakatime30DayLangChart').getContext('2d');
            new Chart(ctx30Days, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: dataValues,
                        backgroundColor: backgroundColors,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            display: false,
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    let index = context.dataIndex; // Get the index of the current segment
                                    let time = timeSpent[index];  // Get the time spent on that language
                                    if (label) {
                                        label += ': ';
                                    }
                                    // Display both percentage and time
                                    label += context.raw.toFixed(2) + '%'; // Show percentage
                                    label += ' (' + time + ')'; // Append time spent
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching WakaTime data for 30 Days:', error));

    // Load WakaTime data for "All Time"
    fetch('https://wakatime.com/share/@telloviz/735e4f4d-0406-457a-a0e3-b376bf66fbb8.json')
        .then(response => response.json())
        .then(data => {
            const labels = data.data.map(lang => lang.name);
            const dataValues = data.data.map(lang => lang.percent);
            const backgroundColors = data.data.map(lang => lang.color);
            const timeSpent = data.data.map(lang => lang.text); // Time spent on each language

            // Initialize the "All Time" chart
            const ctxAllTime = document.getElementById('wakatimeAllTimeLangChart').getContext('2d');
            new Chart(ctxAllTime, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: dataValues,
                        backgroundColor: backgroundColors,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            display: false,
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    let index = context.dataIndex; // Get the index of the current segment
                                    let time = timeSpent[index];  // Get the time spent on that language
                                    if (label) {
                                        label += ': ';
                                    }
                                    // Display both percentage and time
                                    label += context.raw.toFixed(2) + '%'; // Show percentage
                                    label += ' (' + time + ')'; // Append time spent
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching WakaTime data for All Time:', error));
});

    </script>
</body>

</html>